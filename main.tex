\documentclass[water,article,submit,pdftex,moreauthors]{Definitions/mdpi}

\graphicspath{{./fig/}}

% MDPI internal commands - do not modify
\firstpage{1}
\makeatletter
\setcounter{page}{\@firstpage}
\makeatother
\pubvolume{1}
\issuenum{1}
\articlenumber{0}
\pubyear{2025}
\copyrightyear{2025}
%\externaleditor{Firstname Lastname} % More than 1 editor, please add `` and '' before the last editor name
\datereceived{ }
\daterevised{ } % Comment out if no revised date
\dateaccepted{ }
\datepublished{ }
%\datecorrected{} % For corrected papers: "Corrected: XXX" date in the original paper.
%\dateretracted{} % For retracted papers: "Retracted: XXX" date in the original paper.
\hreflink{https://doi.org/} % If needed use \linebreak
%\doinum{}
%\pdfoutput=1 % Uncommented for upload to arXiv.org
%\CorrStatement{yes}  % For updates
%\longauthorlist{yes} % For many authors that exceed the left citation part

%=================================================================
% Add packages and commands here. The following packages are loaded in our class file: fontenc, inputenc, calc, indentfirst, fancyhdr, graphicx, epstopdf, lastpage, ifthen, float, amsmath, amssymb, lineno, setspace, enumitem, mathpazo, booktabs, titlesec, etoolbox, tabto, xcolor, colortbl, soul, multirow, microtype, tikz, totcount, changepage, attrib, upgreek, array, tabularx, pbox, ragged2e, tocloft, marginnote, marginfix, enotez, amsthm, natbib, hyperref, cleveref, scrextend, url, geometry, newfloat, caption, draftwatermark, seqsplit
% cleveref: load \crefname definitions after \begin{document}

% Full title of the paper (Capitalized)
\Title{Intercomparison of Runoff and River Discharge Reanalysis Datasets at the Upper Jinsha River, an Alpine River on the Eastern Edge of the Tibetan Plateau}

% MDPI internal command: Title for citation in the left column
\TitleCitation{Intercomparison of Runoff and River Discharge Reanalysis Datasets at the Upper Jinsha River}

% Author Orchid ID: enter ID or remove command
\newcommand{\orcidauthorA}{0000-0002-5629-4795} % Add \orcidA{} behind the author's name
\newcommand{\orcidauthorB}{0000-0001-7580-9128} % Add \orcidB{} behind the author's name

% Authors, for the paper (add full first names)
\Author{Shuanglong Chen $^{1,\dagger}$, Heng Yang $^{2,\dagger}\orcidA{}$, and Hui Zheng $^{3,}$*\orcidB{}}

%\longauthorlist{yes}

% MDPI internal command: Authors, for metadata in PDF
\AuthorNames{Shuanglong Chen, Heng Yang and Hui Zheng}

% MDPI internal command: Authors, for citation in the left column, only choose below one of them according to the journal style
\AuthorCitation{Chen, S.; Yang, H.; Zheng, H.}

% Affiliations / Addresses (Add [1] after \address if there is only one affiliation.)
\address{
  $^{1}$ \quad Baihetan Hydropower Plant, China Three Gorges Corporation, Sichuan 615421, China; \url{chen\_shuanglong@ctg.com.cn}\\
  $^{2}$ \quad Science and Technology Research Institute, China Three Gorges Corporation, Beijing 100038, China; \url{yang\_heng2@ctg.com.cn}\\
  $^{3}$ \quad Institute of Atmospheric Physics, Chinese Academy of Sciences, Beijing 100029, China; \url{hzheng\_iap@outlook.com}\\
}

% Contact information of the corresponding author
\corres{Correspondence: \url{hzheng\_iap@outlook.com}}

% Current address and/or shared authorship
\firstnote{These authors contributed equally to this work and should be considered co-first authors.}

%\simplesumm{} % Simple summary

% Abstract (Do not insert blank lines, i.e. \\)
\abstract{This study assesses the effectiveness and limitations of publicly accessible runoff and river discharge reanalysis datasets through an intercomparison in the Upper Jinsha River, an alpine region with substantial hydropower potential on the eastern edge of the Tibetan Plateau. The examined datasets are the European Centre for Medium-Range Weather Forecast Reanalysis version 5 (ERA5-Land), the Global Flood Awareness System (GloFAS), the Global Reach-Level Flood Reanalysis (GRFR), and the China Natural Runoff Dataset (CNRD). These datasets are created using various meteorological forcing, runoff generation models, river routing models, and calibration methods. To determine the causes of discrepancies, additional simulations were carried out. One simulation, driven by meteorological forcing similar to that of ERA5-Land and GloFAS but utilizing the uncalibrated NoahMP land surface model at a higher spatial resolution, was included to evaluate the effects of meteorological inputs, spatial resolution, and calibration on runoff estimation. Runoff from all datasets was rerouted on a high-resolution river network derived from the 3-arcsecond Multi-Error-Removed Improved-Terrain Hydrography (MERIT-Hydro) dataset, allowing for a comparison between vector- and grid-based river routing models for discharge estimates. The intercomparison is grounded in observations from three gauging stations—Zhimenda, Gangtuo, and Benzilan—at monthly, daily, and hourly scales. The results suggest that model calibration has a more significant influence on runoff and discharge estimates than meteorological data. Calibrated datasets, such as GloFAS and GRFR, perform better than others, despite variations in the forcing data. The runoff characteristics-based calibration method used in GRFR exhibits superior performance at Zhimenda and Benzilan. However, at Gangtuo, GRFR's performance is unsatisfactory, highlighting the limitation of the machine-learning-based method in regions with rugged terrain and limited observations. Vector-based river routing models demonstrate advantages over grid-based models. GloFAS, which uses a grid-based routing model, encounters difficulties in simultaneously producing accurate runoff and discharge estimates. The intercomparison shows that GRFR's river routing is sub - optimally configured. However, when GRFR's runoff rerouted, the performance of discharge improves substantially, attaining a Kling--Gupta Efficiency of approximately 0.9. These findings offer valuable insights for the further development of reanalysis datasets in this region.}

% Keywords
\keyword{runoff; river discharge; model intercomparison; Upper Jinsha River}

\begin{document}

\section{Introduction}

The rapid growth of global- and continental-scale runoff and discharge reanalysis datasets marks a significant advancement in hydrological research. Datasets such as the European Centre for Medium-Range Weather Forecasts (ECMWF) Reanalysis version 5 (ERA5) \citep{hersbach2020QJMRS}, ERA5-Land \citep{munoz-sabater2021ESSD}, the Global Flood Awareness System (GloFAS) \citep{alfieri2020JH, harrigan2020ESSD}, and the Global Reach-Level Flood Reanalysis (GRFR) \citep{yang2021BAMS, lin2019WRR} provide continuous, spatially comprehensive runoff and river discharge estimates. Additionally, regional datasets like the National Water Model (NWM) of the United States \citep{cosgrove2024JAWRA}, the European Flood Early Warning Systems \citep{najafi2024NC}, and the China Natural Runoff Dataset (CNRD) \citep{gou2021BAMS, miao2022CSB} provide runoff and discharge estimates tailored to specific regions. These datasets have greatly improved our understanding of river systems \citep{feng2021NC, collins2024NG} and their interactions with other components of the Earth system \citep{liu2024NG}. Furthermore, they have been instrumental in supporting decision-making processes, particularly in the area of water-resources utilization and flood protection \citep{cosgrove2024JAWRA, coughlan_de_perez2016HESS}.

Reanalysis datasets are generated through a complex chain of methodologies that include meteorological forcing data, land surface models or hydrological models, river routing models, river network delineations, and calibrations. The diversity among these components can significantly influence the estimation of runoff and river discharge. Studies have demonstrated that meteorological forcing data can differ remarkably \citep{sun2018RG, henn2018JH}. The use of different meteorological forcing data \citep{renard2010WRR, bai2024JGRA}, in combination with varying model structure \citep{butts2004JH}, spatial resolutions \citep{haddeland2002WRR, barnhart2024WRR, li2022GMD}, parameterizations \citep{zheng2019WRR,zheng2023ESSD}, and parameters \citep{li2020JAMS} of land surface models or hydrological models, can lead to disparate estimates of runoff \citep{saxe2021HESS, beck2017HESS}. Furthermore, these differences in runoff estimation can be further amplified by the methods employed in river routing \citep{fry2014JH, mai2022HESS, ahmed2023JH}.

The diversity in estimation methodologies necessitates careful intercomparison before using reanalysis datasets. In the past decades, a variety of intercomparison studies have been conducted with different objectives. Land surface model comparisons such as the Project for Intercomparison of Land-surface Parameterization Schemes \citep{henderson-sellers1993BAMS} and the Land Surface, Snow and Soil Moisture Model Intercomparison Project \citep{van_den_hurk2016GMD} conducted with the same meteorological forcing data greatly help to reveal the weakness of the participant models and the interactions of land surface processes. The Distributed Model Intercomparison Project \citep{reed2004JH, smith2004JH} compared distributed models with lumped models. This project revealed the superiority of distributed routing models in reproducing flood peaks and reported the importance of calibration on distributed rainfall-runoff models. \citet{beck2017HESS} compared ten hydrological models at the global scale. Their results further confirm that proper parameter calibration is vital for accurate runoff estimation. The Continental Hydrological Intercomparison Project \citep{tijerina2021WRR} compared two high-resolution, physics-based models at the continental scale. The intercomparison promotes high-resolution modeling to enhance topographic processing and to improve topographic representation over complex topography. There are also intercomparisons with regional focuses. The Great Lakes Runoff Intercomparison Project \citep{mai2022HESS} and the Nelson Model Intercomparison Project under the Integrated Modelling Program of Canada initiative \citep{ahmed2023JH} are two examples. These intercomparison studies aim to select the best-performing estimation methodologies for the region and guide further improvements of operations.

The Upper Jinsha River, the source of the Changjiang River, is notable for its steep gradient and high hydroelectric potential. The river is located on the eastern edge of the Tibetan Plateau. Thirteen hydroelectric facilities have been built or planned along its main stem, collectively possessing an installed capacity of approximately 14.6 gigawatts. The river originates from the Tibetan Plateau. The source area of the river consists of a major part of the Sanjiangyuan National Nature Reserve, the highest and largest nature reserve in China yet. The operations of hydroelectric facilities and natural reserves require accurate estimation of water resources. However, the scarcity of in-situ hydrometeorological observations in the region is a notable challenge. In this context, reanalysis datasets of runoff and discharge emerge as an indispensable data source for the area. Simultaneously, the Upper Jinsha River's intricate topography, high-alpine environmental conditions, and the pressing need for accurate runoff and river discharge estimations render it an exemplary testing ground for these reanalysis datasets.

This study intercompares runoff and river discharge reanalysis data obtained from ERA5-Land, GloFAS, GRFR, and CNRD for the Upper Jinsha River as a pilot analysis. The primary objective is to assess the effectiveness and limitations of the methodologies employed in these reanalyses, providing insights to guide future improvements in runoff and discharge estimation.

\section{Materials and Methods}

Figure~\ref{fig:domain} illustrates the terrain and river network of the upper Jinsha River. The study area encompasses the region upstream of the Benzilan gauging station. The elevation ranges from approximately 6600 m at its highest point to 2000 m at its lowest. The river network was extracted from the Multi-Error-Removed Improved-Terrain Hydrography (MERIT-Hydro) dataset~\citep{yamazaki2019WRR, yamazaki2017GRL}. MERIT-Hydro is a globally recognized dataset providing hydrologically conditioned elevation, flow direction, and flow accumulation area data, with a spatial resolution of 3 arc-seconds. The river network was extracted using a flow accumulation area threshold of 25 km\textsuperscript{2}, resulting in 5,787 river reaches.

\begin{figure}[H]
  \includegraphics[width=0.8\textwidth]{domain.pdf}
  \caption{Study domain and river network of the source region of the upper Jinsha River. White crosses mark the gauging stations: ZMD for Zhimenda, GT for Gangtuo, and BZL for Benzilan.\label{fig:domain}}

\end{figure}

\subsection{Reanalysis Datasets}

Table~\ref{tab:dataset} presents an overview of the datasets employed in this study. ERA5-Land~\citep{munoz-sabater2021ESSD} is an enhanced global dataset, an improvement over ERA5~\citep{hersbach2020QJMRS}. This dataset features a significant improvement in spatial resolution, increasing from ERA5's 31 km to 0.1\textdegree{} globally. A variety of land surface variables, including runoff, are simulated using the Carbon Hydrology-Tiled ECMWF Scheme for Surface Exchanges over Land (CHTESSEL) model~\citep{boussetta2021A, balsamo2009JHM}, operating at an hourly temporal resolution.

The GloFAS historical reanalysis version 4.0~\citep{alfieri2020JH, harrigan2020ESSD} is another dataset produced by the European Centre for Medium-Range Weather Forecasts (ECMWF), with a focus on hydrological variables. GloFAS shares the same spatial resolution of 0.1\textdegree{} as ERA5-Land. It is driven by ERA5 meteorological data, which is highly similar to ERA5-Land. The primary distinctions between GloFAS and ERA5-Land lie in the hydrological model employed, the temporal resolution, and the output variables. GloFAS utilizes the LISFLOOD model~\citep{knijff2010IJGIS} at a daily time step. Unlike ERA5-Land, the parameters of LISFLOOD are calibrated against daily river discharge observations using an evolutionary algorithm~\citep{hirpa2018JH}. LISFLOOD simulates both runoff and river discharge, whereas ERA5-Land provides only runoff estimates.

The GRFR dataset~\citep{yang2021BAMS} is a comprehensive global dataset providing runoff and river discharge data at a 3-hourly temporal resolution. The runoff is simulated using the Variable Infiltration Capacity (VIC) model~\citep{liang1994JGRA} at a spatial resolution of 0.05\textdegree, which is driven by precipitation data from the Multi-Source Weighted-Ensemble Precipitation (MSWEP) dataset~\citep{beck2019BAMS} and other meteorological variables from ERA5. The VIC model's parameters are calibrated~\citep{yang2019WRR} at each 0.05\textdegree{} grid cell against a machine-learning-derived runoff characteristics dataset produced by~\citet{beck2015JHM}. The bias in the VIC-simulated runoff is further corrected using the same runoff characteristics dataset, following the methodology of~\citet{lin2019WRR}. The calibrated and bias-corrected runoff data are then utilized to drive the Routing Application for Parallel computatIon of Discharge (RAPID) river routing model~\citep{david2011JHM} for simulating river discharge. The parameters of RAPID are estimated using a statistical relationship that correlates discharge with river width, water depth, channel slope, and celerity~\citep{lin2019WRR}. The river network employed in the routing process is also derived from the MERIT Hydro dataset~\citep{lin2021SD}.

The China Natural Runoff Dataset (CNRD) \citep{gou2021BAMS, miao2022CSB} comprises runoff data at a 0.25° spatial resolution. This dataset is simulated using the VIC model, driven by the China Meteorological Forcing Dataset \citep{he2020SD}. The parameters of the VIC model were calibrated against river discharge observations from approximately 200 catchments across China and then extrapolated to ungauged river basins using the multiscale regionalization method \citep{samaniego2010WRR}.

As presented in Table~\ref{tab:dataset}, a new dataset was generated in this study for comparative purposes. This dataset was driven by ERA5-Land meteorological data and simulated via a distinct land surface model and river routing model. Given that the new dataset shares a similar meteorological forcing dataset with GloFAS and ERA5-Land, this comparison can effectively isolate the impacts of model selection, spatial resolution, and calibration on runoff and discharge estimations. The model employed in this study emulates the National Water Model (NWM). The Noah with Multi - Parameterization (NoahMP) land surface model \citep{niu2011JGRA} was utilized, operating at a spatial resolution of 0.01° from 2008 to 2016. The static parameters for NoahMP are derived from the Weather Research and Forecasting geographic static data (\url{https://www2.mmm.ucar.edu/wrf/users/download/get_sources_wps_geog.html}). The initial condition for 2008 is sourced from ERA5-Land. The first year is allocated for model spin-up, with the simulated runoff from 2009 to 2016 used for analysis. NoahMP offers a variety of parameterization schemes for land surface processes, and we adopted the same schemes as those used in the NWM of the United States \citep{cosgrove2024JAWRA}. The runoff is routed using the variable-parameter Muskingum--Cunge (MC) method on the river network depicted in Figure~\ref{fig:domain} to estimate river discharge. The routing algorithm mirrors that of the NWM, assuming a trapezoidal channel cross-section. Channel cross-section geometry and roughness parameters are sourced from the default parameter lookup table of the NWM \citep{read2023JAWRA} and the Strahler stream order for each river reach within the network. In theory, the MC routing method would outperform the kinematic wave routing method used in GloFAS by also additionally considering diffusive wave dynamics, while the Muskingum routing method used in GRFR would be the least performing among the three. It is important to note that this comparison is theoretical, and actual performance can vary significantly with model implementation and parameter settings

\subsection{River discharge observations}\label{sec:obs}

We utilized river discharge observations from three gauging stations along the mainstream of the upper Jinsha River: Zhimenda (ZMD), Gangtuo (GT), and Benzilan (BZL), covering the period from 2009 to 2016. Zhimenda serves as the demarcation point between the source region of the Changjiang River and the Upper Jinsha River. All the planned hydroelectric power stations are located on the river segment stretching between Zhimenda and Benzilan. The inclusion of Gangtuo provides additional data coverage along the river's mainstream. By choosing these stations, the performance of reanalysis datasets in a region of high hydropower potential and complex hydrological processes can be assessed. The selection of this timeframe is justified by the minimal presence of hydroelectric facilities, which ensures that the river discharge data are largely unaffected by human interventions.

The dataset from Zhimenda is compiled at a daily resolution. The dataset comprises 1,477 records, with 49\% of the days missing between 2009 and 2016. In contrast, Gangtuo and Benzilan provide data at an hourly resolution, aaccumulating 52,246 hours and 69,011 hours, respectively. The respective missing data rates for these stations are 25\% for Gangtuo and 1.6\% for Benzilan. Given the nature of our analysis, we have chosen not to impute the missing values, opting instead to focus solely on the complete data records. This choice was made with the aim of maximizing the utilization of available observations in this region where data are scarce. Additionally, by avoiding the use of gap-filling methods, we sought to minimize the potential biases that could be introduced, especially given the proportion of missing data is substantial.

To our knowledge, the daily river discharge observations at Zhimenda have been used to calibrate GloFAS and GRFR, while the observations at Gangtuo and Benzilan have not been incorporated into the datasets analyzed in this study.

\begin{table}[H]
  \caption{The datasets used in this study.}
  \label{tab:dataset}
  \centering
  \small
  \begin{tabularx}{\textwidth}{CCCCCC}
    \toprule
    \textbf{Dataset} & \textbf{Time period} & \textbf{Temporal Resolution} &
    \textbf{Runoff Resolution} & \textbf{River Routing} & \textbf{References} \\
    \midrule
    \multicolumn{6}{c}{\textit{Publically available datasets}} \\
    ERA5-Land & 1950--Present & Hourly & 0.10\textdegree & N/A & \citet{munoz-sabater2021ESSD} \\
    GloFAS v4.0 & 1979--Present & Daily & 0.10\textdegree & LISFLOOD & \citet{harrigan2020ESSD} \\
    GRFR v1.0 & 1980--2019 & 3-hourly & 0.05\textdegree & RAPID & \citet{yang2021BAMS} \\
    CNRD v1.0 & 1961--2018 & Monthly & 0.25\textdegree & N/A & \citet{miao2022CSB} \\
    \multicolumn{6}{c}{\textit{Datasets produced in this study}} \\
    ERA5-Land/ NoahMP & 2009--2016 & Hourly & 0.01\textdegree & MC & This study\\
    \bottomrule
  \end{tabularx}
\end{table}

\subsection{Evaluation methods}

As shown in Table~\ref{tab:dataset}, the datasets vary in spatial and temporal resolution. River discharge estimates are not available in every dataset examined. To address these inconsistencies, we remapped the runoff onto a common 0.01° grid and refined both daily and monthly values to hourly values, as depicted in Figure~\ref{fig:workflow}. The spatial remapping was conducted using a first-order conservative method. For temporal refinement, we used the fraction of hourly ERA5-Land runoff to the accumulated runoff within a day or a month to redistribute the daily or monthly values. Subsequently, the runoff from all datasets was routed using the same Muskingum--Cunge (MC) method, as previously described, to estimate river discharge. For GloFAS and GRFR, which provide river discharge estimates, we also refined the 3-hourly or daily values to hourly values using the same refinement method as the runoff.

The river discharge estimates derived from the Muskingum--Cunge method, as well as the temporally refined river discharge data from GRFR and GloFAS, are then compared with the observations at the gauging stations. This evaluation is conducted across three temporal scales—monthly, daily, and hourly—to comprehensively assess the accuracy and consistency of the estimates with the actual observations.

The structure and parameters of the river routing model significantly influence the river discharge estimates. To isolate the impact of river routing on these estimates, we not only compared the model-derived river discharge with observations at gauging stations but also aggregated the runoff above these stations for a more direct comparison. This aggregation helps to isolate the effects of routing by focusing on the input runoff rather than the routing process itself. The aggregated runoff is calculated by summing the runoff within the upstream area of each gauging station. The delineation of the upstream area was based on the flow direction data from the MERIT-Hydro dataset.

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{workflow.pdf}
  \caption{Workflow of this study.\label{fig:workflow}}
\end{figure}

\subsection{Evaluation metrics}

We employed the Kling-Gupta Efficiency (KGE) \citep{gupta2009JH} to assess the performance of the reanalysis datasets. The KGE shares similarities with the commonly used Mean-Square Error (MSE) and Nash--Sutcliffe Efficiency (NSE). It incorporates the correlation coefficient, the ratio of the standard deviations, and the ratio of the mean values of both the observed and simulated data. Unlike MSE or NSE, in the KGE, these three components are combined in an independent manner. This enables a straightforward separation of their relative contributions to the overall metric. The KGE is formulated as follows:
\begin{align}
  \label{eq:kge}
  \text{KGE} =& 1 - \sqrt{G_1^2 + G_2^2 + G_3^2} \text{,} \\
  G_1 =& r - 1 \text{,} \\
  G_2 =& \frac{\sigma_s}{\sigma_o} - 1 \text{,} \\
  G_3 =& \frac{\mu_s}{\mu_o} - 1 \text{,}
\end{align}
where $r$ is the correlation coefficient, $\sigma_s$ and $\sigma_o$ are the standard deviations of the simulated and observed data, respectively, and $\mu_s$ and $\mu_o$ are the mean values of the simulated and observed data, respectively. The KGE ranges from $-\infty$ to 1, with a value of 1 indicating a perfect match between the simulated and observed data. A KGE value significantly less than 1 indicates a poor match.

The relative contribution of the three terms in the KGE can be calculated using the following formula \citep{gupta2009JH}:
\begin{equation}
  g_i = \frac{G_i^2}{G_1^2 + G_2^2 + G_3^2} \text{,} \quad \text{for}
  \  i = 1, 2, 3 \text{,}
\end{equation}
where $g_1$, $g_2$, and $g_3$ are the relative contributions of correlation coefficient, variability, and bias, respectively. A higher value indicates a greater contribution of the corresponding term to the deviation of the KGE from 1.

\section{Results and discussion}

\subsection{Runoff}

Figure~\ref{fig:runoff_spatial} geographically compares the runoff estimates within the Benzilan catchment. The five datasets fall into three categories: ERA5-Land and ERA5-Land/NoahMP; GloFAS and GRFR; and CNRD. The first group utilizes uncalibrated land surface models, the second group employs extensively calibrated hydrological models, and the third group features a hydrological model with parameters that are regionalized rather than individually calibrated. Notably, ERA5-Land, ERA5-Land/NoahMP, and GloFAS exhibit significant differences despite similar meteorological forcing data. On the other hand, GloFAS and GRFR, which are driven by different meteorological forcing data, show close spatial patterns. This comparison indicates that the calibration of land surface models or hydrological models has a profound impact on runoff estimation, more than the meteorological data.

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{runoff_mean.pdf}
  \caption{Intercomparison of the spatial distribution of multiyear averaged runoff from 2009 to 2016.\label{fig:runoff_spatial}}
\end{figure}

Figure~\ref{fig:runoff_agg_ts} intercompares the monthly variations and annual cycle of the aggregated runoff above Zhimenda, Gangtuo, and Benzilan. Since the river flow travel time is typically smaller than a month \citep{allen2018GRL}, it is generally safe to neglect the impact of river routing at the monthly time scale. Both ERA5 and CNRD overestimate the runoff at all examined stations, but the reasons for this overestimation differ. The overestimation in ERA5 is consistent with previous studies, which attribute it to overestimated precipitation in high-altitude regions \citep{bian2019JHM, bian2020JGRA, sun2021ERL, wang2024RS}. In contrast, the overestimation of CNRD is primarily observed in the upstream area of Zhimenda. Given that CMFD, the meteorological data that drive CNRD, has shown closeness to in-situ precipitation observations in this region \citep{wang2024RS}, the overestimation of the CNRD runoff is likely due to less constrained hydrological model parameters. CNRD uses parameters calibrated at gauged basins and extrapolates these parameters to ungauged basins using multiscale regionalization functions \citep{gou2021BAMS, miao2022CSB}. The scarcity of river discharge gauges on the Tibetan Plateau means that this extrapolation can lead to bias.

The runoff from ERA5-Land/NoahMP exhibits two peaks, particularly in the high-altitude regions above Zhimenda. In contrast, ERA5-Land, which utilizes the same meteorological data, shows an insignificant rise in runoff during Spring. The discrepancy between ERA5-Land/NoahMP and ERA5-Land is likely due to differences in the spatial resolution of the land surface model. The higher resolution of ERA5-Land/NoahMP allows for a better capture of the vertical gradient of land surface temperature. The combination of overestimated precipitation in the ERA5-Land meteorological data and increased snowmelt in low-altitude model grids \citep{barnhart2024WRR} results in an artificial spring runoff peak not observed in actual data.

The two calibrated datasets, GloFAS and GRFR, exhibit distinct behaviors. This difference is even evident at Zhimenda, where observations are publicly available through the Global Runoff Data Centre and have been utilized in both datasets. The distinct calibration approaches of the two datasets likely account for this difference. GloFAS is calibrated against river discharge observations \citep{hirpa2018JH}, while its runoff is not directly calibrated. Since river discharge can be calculated by multiplying the catchment area by runoff, different estimates of the catchment area will lead to different runoff values after the calibration of river discharge. In contrast, GRFR's runoff is directly calibrated against a machine-learning-derived runoff characteristics dataset \citep{yang2019WRR}. The results suggest that the calibration method employed by GRFR is highly effective, yielding the best-performing runoff among the examined datasets.

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{runoff_agg_ts.pdf}
  \caption{Intercomparison of the aggregated runoff at the gauging stations. (\textbf{a}) monthly aggregated runoff at Zhimenda; (\textbf{b}) annual cycle of the aggregated runoff at Zhimenda; (\textbf{c}) monthly aggregated runoff at Gangtuo; (\textbf{d}) annual cycle of the aggregated runoff at Gangtuo; (\textbf{e}) monthly aggregated runoff at Benzilan; and (\textbf{f}) annual cycle of the aggregated runoff at Benzilan.\label{fig:runoff_agg_ts}}
\end{figure}

Figure~\ref{fig:runoff_kge} presents the performance of the aggregated runoff in comparison with discharge observations at the monthly time scale. ERA5-Land consistently underperforms across all stations and time scales, corresponding to the overestimation shown in Figure~\ref{fig:runoff_agg_ts}. CNRD also performs poorly in high-altitude areas above Gangtuo due to overestimation, but its performance improves at Benzilan. The performance of CNRD slightly outperforms the high-resolution ERA5-Land/NoahMP. Among the examined datasets, the two calibrated datasets, GloFAS and GRFR, perform the best at almost every station examined, highlighting the importance of calibration for land surface models or hydrological models. Notably, GRFR's performance is exceptionally good, with a KGE above 0.8 at Zhimenda and Benzilan. GRFR's high performance underscores the effectiveness of the characteristics-based calibration method. Meanwhile, GRFR shows subpar performance at Gangtuo. This underperformance can be attributed to the underestimation of both the variability and the long-term mean, as illustrated in Figure~\ref{fig:streamflow_kge_comp}c. Since both variability and the long-term mean are the characteristics to which GRFR is calibrated, the poor performance of GRFR at Gangtuo implies that the machine-learning-derived runoff characteristics dataset does not accurately represent the runoff characteristics at Gangtuo. This is likely because the terrain at Gangtuo is steep, and the observations from this location were not incorporated into the training dataset.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.6\textwidth]{runoff_agg_kge_mon.pdf}
  \caption{Kling--Gupta Efficiency of the monthly aggregated runoff. (\textbf{a}) the measures at Zhimenda, (\textbf{b}) the measures at Gangtuo, and (\textbf{c}) the measures at Benzilan.}
  \label{fig:runoff_kge}
\end{figure}

\subsection{Streamflow}

Figure~\ref{fig:streamflow_ts} compares the monthly discharge estimations with observations. The patterns generally follow the runoff pattern shown in Figure~\ref{fig:runoff_agg_ts}. The overestimation observed in ERA5-Land and CNRD closely mirrors their runoff overestimation. The artificial Spring peak, which is also present in the ERA5-Land/NoahMP discharge, aligns with the runoff pattern.

It is interesting to note that the GloFAS and GRFR discharge behave differently from the runoff. Our rerouted GloFAS runoff (GloFAS-MC in Figure~\ref{fig:streamflow_ts}) can reproduce the underestimated patterns observed for the runoff (Figure~\ref{fig:runoff_agg_ts}), confirming that GloFAS underestimates runoff. However, the underestimation of runoff is no longer presented in the river discharge. GloFAS closely reproduced the observed river discharge (Figure~\ref{fig:streamflow_ts}). The contradiction between the runoff underestimation and the unbiased discharge estimation suggests that the spatial resolution of GloFAS's routing grid plays a role. GloFAS is routed on a $\frac{1}{10}$° grid cell basis, whereas the river basins delineated in this study (as shown in Figure~\ref{fig:domain}) are based on $\frac{1}{1200}$° grids. The resolution of GloFAS may be too coarse to accurately delineate the river basins. However, this error is mitigated in the discharge due to the calibration, and the impact is transferred to errors in the runoff.

Despite the high skill of GRFR's runoff demonstrated in Figure~\ref{fig:runoff_agg_ts}, the skill of GRFR's discharge is unexpectedly unsatisfactory. GRFR remarkably overestimates discharge at all gauging stations. The overestimation is also reported in literature \citep{tu2024JH, cui2025W}. We argue that neither the dynamics nor the parameters of the river routing model should have such significant impacts on monthly discharge, the unexpected overestimation in GRFR is likely attributable to some inadequate configurations of the river routing model. Our rerouted discharge (GRFR-MC) using the GRFR runoff and the Muskingum--Cunge routing method can closely reproduce the observed discharge patterns. This confirms that the overestimation in GRFR is not due to the runoff but rather the routing process.

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{streamflow_ts.pdf}
  \caption{Same as Figure~\ref{fig:runoff_agg_ts}, but for river discharge.}
  \label{fig:streamflow_ts}
\end{figure}

Figure~\ref{fig:streamflow_runoff_dist} presents the river discharge estimates compared with both daily and hourly observations. The aggregated runoff is also displayed for comparison. The difference between aggregated runoff and river discharge highlights the impact of river routing. The comparison shows that river routing has a marginal impact in low flow conditions and at the monthly time scale. The impact increases with the flow rate and on shorter time scales. Significant impacts of the river routing are found on the hourly high flow estimations at all gauging stations. This finding suggests the indispensable role of river routing in flood forecasting.

The differences among the examined river discharge estimates are mainly exhibited in high flow conditions. However, these differences do not vary significantly with the time scale of the estimates (i.e., daily or hourly). The GRFR river discharge estimation suspiciously indicates a high probability of discharge at approximately 4000~$\mathrm{m^3\,s^{-1}}$ at all the examined stations, whereas such a high probability is not found in the other estimates including GRFR-MC. This suspicious pattern is another strong evident of inadequate configurations within GRFR's routing process. The GloFAS estimate can well reproduce the observed discharge probability patterns. Our rerouted river discharge using the GloFAS runoff and the Muskingum--Cunge method deviates from the observed pattern of discharge probability. The discrepancy arises from the calibration of river discharge, which compensates for imprecise river basin area estimation.

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{streamflow_runoff_dist.pdf}
  \caption{Intercomparison of the probability distribution of river discharge and aggregated runoff at the river gauging stations. (\textbf{a}) daily estimates at Zhimenda; (\textbf{b}) hourly estimates at Zhimenda; (\textbf{c}) daily estimates at Gangtuo; (\textbf{d}) hourly estimates at Gangtuo; (\textbf{e}) daily estimates at Benzilan; (\textbf{f}) hourly estimates at Benzilan. Dotted lines denote the aggregated runoff. Solid lines denote the river discharge estimates provided by the examined datasets. Dashed lines denote the river discharge estimates using the runoff and the Muskingum--Cunge routing method. Zhimenda is not shown in the hourly estimates due to the lack of hourly observations.}
  \label{fig:streamflow_runoff_dist}
\end{figure}

Figure \ref{fig:streamflow_kge} illustrates the skill scores for the estimation of river discharge across monthly, daily, and hourly temporal scales. At the monthly scale, the river discharge estimation's skill closely mirrors that of the runoff, as depicted in Figure \ref{fig:runoff_kge}. The coincidence hints that the primary determinant of river discharge variability within the study area is the runoff estimation, rather than the river routing process. An exception to this pattern is observed with GloFAS, where the divergence in discharge skill scores from those of runoff is likely due to the coarse and imprecise river routing grid employed, as previously discussed.

Among the examined dataset, GloFAS, GloFAS-MC, and GRFR-MC perform the best at all gauging stations and across all time scales. Proper calibration of the land surface model and the hydrological model is essential for accurate river discharge estimation. As revealed in Figure~\ref{fig:streamflow_kge_comp}, the primary reasons for the poor performance of the examined datasets, except for GRFR-MC, are errors in reproducing the observed mean and variability of river discharge. GRFR-MC can effectively reproduce the observed mean and variability of river discharge. The KGE of GRFR-MC's hourly discharge can reach a high score of approximately 0.9 at Benzilan, which again confirms the effectiveness of the characteristics-based calibration method. The relatively lower performance of GRFR at Gangtuo implies that the machine-learning-based calibration method employed by GRFR needs to incorporate more local observations to enhance its applicability in specific regions. At all three gauging stations, the deviation of the KGE from 1 for GRFR-MC is mainly attributed to the correlation coefficient, which can be further improved through the calibration of the river routing parameters. The exceptionally high skill of GRFR-MC again confirms the effectiveness of the characteristics-based calibration method.

It is worth noting that the KGE (Figure~\ref{fig:streamflow_kge}) and the relative contribution within the KGE (Figure~\ref{fig:streamflow_kge_comp}) are consistent for both hourly and daily estimates. This consistency suggests that calibration at the daily time scale could potentially be applied to the hourly time scale. The relative contributions of the correlation coefficient, variability, and bias, differ, however, between the monthly, daily, and hourly time scales, as illustrated in Figure~\ref{fig:streamflow_kge_comp}. At the monthly scale, the datasets under examination mainly exhibit differences in the variability and bias of river discharge estimations. The correlation coefficient plays a relatively minor role, indicating that all the examined datasets are capable of reasonably capturing the timing of the peak discharge, as evidenced by Figure~\ref{fig:streamflow_ts}. In contrast, at the daily and hourly scales, the correlation coefficient emerges as a crucial factor. This suggests that the examined datasets face challenges in accurately reproducing the observed timing of floods.

The KGE of river discharge is also consistent between daily and monthly estimates for most datasets, with the exception of the high-resolution ERA5-Land/NoahMP estimation  (Figure~\ref{fig:streamflow_kge}). The increase in KGE from the monthly to daily time scale indicates that a more accurate representation of the spatial distribution of runoff and river routing could improve the temporal variations in river discharge estimates, aligning with the concept of the time of concentration \citep{beven2020HESS}. However, these findings are based on a limited number of gauging stations and limited time periods. Further studies are needed to validate these preliminary observations.

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{streamflow_kge.pdf}
  \caption{Kling--Gupta Efficiency of the river discharge estimation. (\textbf{a}) the measures at the Zhimenda station, (\textbf{b}) the measures at the Gangtuo station, and (\textbf{c}) the measures at the Benzilan station.}
  \label{fig:streamflow_kge}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{streamflow_kge_comp.pdf}
  \caption{Ternary plot showing the relative contribution of correlation coefficient ($g_1$), variability ($g_2$), and bias ($g_3$) to the deviation of the Kling--Gupta Efficiency of simulated river discharge from one. The three rows of the plot represent the estimation at Zhimenda, Gangtuo, and Benzilan, respectively. The three columns of the plot represent the results of the monthly, daily, and hourly estimates, respectively.}
  \label{fig:streamflow_kge_comp}
\end{figure}

\section{Conclusions}

This study presents a pilot intercomparison of several publicly available large-domain reanalysis datasets of runoff and river discharge in the Upper Jinsha River basin. The datasets under scrutiny include ERA5-Land, GloFAS, GRFR, and CNRD. To enhance the understanding of the effects of calibration, spatial resolution, and meteorological forcing on runoff estimation, a high-resolution runoff simulation has been incorporated into the comparison. The runoff from the examined datasets is rerouted on a high-resolution river network delineated from the 3-arcsecond MERIT-Hydro dataset. This rerouting aids in identifying the impacts of different river routing models and river network delineations on river discharge estimation. The estimated runoff and river discharge are compared with observations at three gauging stations—Zhimenda, Gangtuo, and Benzilan—spanning monthly, daily, and hourly time scales. The principal findings of this study are as follows:

\begin{itemize}
  \item The examined runoff and river discharge reanalysis datasets exhibit significant discrepancies. When compared with observations, the Kling-Gupta Efficiency of river discharge closely aligns with that of runoff. The primary driver of river discharge variability in the study area is runoff estimation, rather than the river routing process. The data and models used in runoff estimation need further scrutinization.
  \item Variations in runoff estimates are predominantly attributed to the calibration processes of land surface and hydrological models. Among the datasets, GloFAS and GRFR, which have been calibrated, demonstrate superior performance in runoff estimation. GloFAS and GRFR show similar runoff patterns, despite being driven by different meteorological forcing data. In contrast, the runoff estimates from GloFAS markedly diverge from those of ERA5-Land, even though the meteorological forcing data are similar.
  \item The runoff characteristics-based calibration method is demonstrated to be highly effective. GRFR, which utilizes this calibration approach, outperforms all the other examined datasets in terms of runoff estimation at Zhimenda and Benzilan. However, this machine-learning-based method is sensitive to the training dataset used. At Gangtuo, GRFR's performance is subpar. This poor performance suggests that the runoff characteristics relevant to Gangtuo are not adequately represented in the calibration dataset. To improve the applicability of this method in specific regions like Gangtuo, more local observations are needed.
  \item Intercomparison proves to be a valuable approach for uncovering the shortcomings within reanalysis datasets. Although the GRFR demonstrates a high level of proficiency in runoff estimation, its performance in discharge estimation shows an unexpected decline. Notably, an uncalibrated re-routing process that employs the Muskingum-Cunge method, utilizing the GRFR runoff data, is able to achieve the most favorable performance in estimating river discharge when compared to the other examined datasets. This outcome strongly implies that the river routing model employed by GRFR is insufficient and requires improvement.
  \item The river routing process is especially important during high-flow conditions and at sub-monthly time scales. This finding underscores the importance of incorporating a river routing model in flood forecasting. Conversely, the impact of river routing is minimal in low flow conditions and at the monthly time scale. The similarity between monthly aggregated runoff and river discharge estimates allows examination of the adequacy of the river routing model and the river network delineation.
  \item A high-resolution river network for flow routing is crucial for concurrent runoff and river discharge estimation. The intercomparison shows a contradiction between GloFAS's high skill in river discharge estimation and relatively low skill in runoff estimation. The contradiction is likely due to the coarse river routing grid. The coarse grid introduces errors in catchment area estimation, which are transferred to the runoff estimates during the calibration of river discharge.
  \item High-resolution runoff simulations exhibit distinct runoff characteristics compared with their low-resolution counterparts. Calibrating high-resolution runoff models can mitigate these discrepancies, but inherent differences in parameter settings may still lead to persistent divergences in other aspects of hydrological cycle.
\end{itemize}

Given the scarcity of in-situ observations in the Upper Jinsha River, reanalysis datasets are indeed irreplaceable for these regions. The findings of this study have implications for both the utilization of existing reanalysis datasets and future development of new ones. For users of reanalysis datasets, the datasets investigated in this study display notable variances in the estimation of runoff and river discharge. Generally, GloFAS has been found to be relatively more reliable for estimating river discharge, while GRFR shows more promise for runoff estimation. For users with prior modeling experience, rerouting the runoff data from GRFR can be beneficial.

For those involved in developing reanalysis datasets, calibrating land surface and hydrological models is a critical step in obtaining accurate runoff and river discharge estimates. The calibration process should be carefully constructed to incorporate as many relevant observations as possible within the target region, to better capture the distinct runoff characteristics. In terms of river routing methods, the vector-based approach demonstrates advantages over the grid-based method. The vector-based method is better represents the detailed geometry of the river network and define the catchment area accurately, which are essential factors for achieving reliable runoff and river discharge estimations.

\vspace{6pt}

\authorcontributions{Conceptualization, H.Z.; methodology, H.Z.; software, H.Z.; validation, S.C. and H.Y.; formal analysis, S.C. and H.Y.; investigation, S.C. and H.Y.; resources, S.C., H.Y. and H.Z.; data curation, S.C. and H.Y.; writing---original draft preparation, S.C. and H.Y.; writing---review and editing, S.C., H.Y., and H.Z.; visualization, S.C. and H.Y.; supervision, H.Z.; project administration, H.Z.; funding acquisition, H.Z. All authors have read and agreed to the published version of the manuscript.}

\funding{This study is funded by China Three Gorges Corporation (contract Z532302035) and the Natural Science Foundation of China (grants 42075165 and 42275178).}

\dataavailability{The MERIT-Hydro dataset was obtained from \url{https://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_Hydro/} (accessed on 2024-11-10). The ERA5-Land dataset was obtained from \url{https://cds.climate.copernicus.eu/datasets/reanalysis-era5-land}. The GloFAS v4.0 dataset was obtained from \url{https://ewds.climate.copernicus.eu/datasets/cems-glofas-historical} (accessed on 2024-11-10). The GRFR v1.0 dataset was obtained from \url{https://www.reachhydro.org/home/records/grfr} (accessed on 2024-11-10). The COMIDs used to extract the river discharge from GRFR are 43037713 for Zhimenda, 43046824 for Gangtuo, and 43066085 for Benzilan, respectively. The CNRD v1.0 dataset was obtained from \url{https://doi.org/10.11888/Atmos.tpdc.272864} (accessed on 2024-11-10). The river discharge observations were obtained from the China Three Gorges Corporation; however, the authors do not have permission to share the data. The delineated river network, the aggregated runoff and simulated river discharge at the gauging stations, along with the scripts for figure generation used throughout this paper, can be found at the GitHub repository \url{https://github.com/hzheng88/paper-2025-upperjsj-streamflow-intercomp} (accessed on 2025-02-03).}

\acknowledgments{We thank for the technical support of the National Large Scientific Infrastructure ``Earth System Numerical Simulation Facility'' (\url{https://cstr.cn/31134.02.EL})}

\conflictsofinterest{Authors Shuanglong Chen and Heng Yang were employed by the China Three Gorges Corporation. The remaining author declares that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.}

\begin{adjustwidth}{-\extralength}{0cm}
  \reftitle{References}

  \bibliography{references}

  \PublishersNote{}
  %\isPreprints{}{% This command is only used for ``preprints''.
\end{adjustwidth}
\end{document}
